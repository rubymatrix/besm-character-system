<div class="bg-white dark:bg-zinc-900 rounded-2xl shadow p-5"
     data-controller="nested-form"
     data-nested-form-wrapper-selector-value="[data-attribute-row]">

  <div class="flex items-center justify-between mb-4">
    <h2 class="text-base font-semibold text-zinc-900 dark:text-zinc-100">Attributes</h2>
    <button type="button"
            class="rounded-xl px-3 py-1.5 text-xs font-medium bg-zinc-200 dark:bg-zinc-800 hover:bg-zinc-300 dark:hover:bg-zinc-700"
            data-action="nested-form#add"
            data-nested-form-template-param="attribute">
      + Add Attribute
    </button>
  </div>

  <div class="space-y-3" data-nested-form-target="container">
    <%= f.fields_for :character_attributes do |af| %>
      <%= render partial: "attribute_row", locals: { af: af } %>
    <% end %>
  </div>

  <!-- Template -->
  <template data-nested-form-target="template" data-template-name="attribute">
    <% new_attr = CharacterAttribute.new %>
    <%= f.fields_for :character_attributes, new_attr, child_index: "NEW_RECORD" do |af| %>
      <%= render partial: "attribute_row", locals: { af: af } %>
    <% end %>
  </template>
</div>